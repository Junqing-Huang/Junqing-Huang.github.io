<!DOCTYPE html>
<!-- _layouts/distill.html --><html>
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Semi-sparsity for Smoothing Filters | Junqing  Huang</title>
    <meta name="author" content="Junqing  Huang">
    <meta name="description" content="We propose a semi-sparsity smoothing method based on a new sparsity-induced minimization scheme. The model is derived from the observations that semi-sparsity prior knowledge is universally applicable in situations where sparsity is not fully admitted such as in the polynomial-smoothing surfaces. We illustrate that such priors can be identified into a generalized $L_0$-norm minimization problem in higher-order gradient domains, giving rise to a new 'feature-aware' filter with a powerful simultaneous-fitting ability in both sparse singularities (corners and salient edges) and polynomial-smoothing surfaces. Notice that a direct solver to the proposed model is not available due to the non-convexity and combinatorial nature of $L_0$-norm minimization. Instead, we propose to solve it approximately based on an efficient half-quadratic splitting technique. We demonstrate its versatility and many benefits to a series of signal/image processing and computer vision applications.">
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700%7CRoboto+Slab:100,300,400,500,700%7CMaterial+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="http://localhost:4000/projects/paper_semi_sparsity_smoothing/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    


    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    <!-- Distill js -->
    <script src="/assets/js/distillpub/template.v2.js"></script>
    <script src="/assets/js/distillpub/transforms.v2.js"></script>
    <script src="/assets/js/distillpub/overrides.js"></script>
    
    <!-- Page/Post style -->
    <style type="text/css">
      .fake-img {
  background: #bbb;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 0px 4px rgba(0, 0, 0, 0.1);
  margin-bottom: 12px;
} .fake-img p {
  font-family: monospace;
  color: white;
  text-align: left;
  margin: 12px 0;
  text-align: center;
  font-size: 16px;
}

    </style>
  </head>

  <body>
<d-front-matter>
    <script async type="text/json">{
      "title": "Semi-sparsity for Smoothing Filters",
      "description": "We propose a semi-sparsity smoothing method based on a new sparsity-induced minimization scheme. The model is derived from the observations that semi-sparsity prior knowledge is universally applicable in situations where sparsity is not fully admitted such as in the polynomial-smoothing surfaces. We illustrate that such priors can be identified into a generalized $L_0$-norm minimization problem in higher-order gradient domains, giving rise to a new 'feature-aware' filter with a powerful simultaneous-fitting ability in both sparse singularities (corners and salient edges) and polynomial-smoothing surfaces. Notice that a direct solver to the proposed model is not available due to the non-convexity and combinatorial nature of $L_0$-norm minimization. Instead, we propose to solve it approximately based on an efficient half-quadratic splitting technique. We demonstrate its versatility and many benefits to a series of signal/image processing and computer vision applications.",
      "comments": "",
      "published": "July 20, 2023",
      "authors": [
        {
          "author": "Junqing Huang<sup>&#9833</sup>",
          "authorURL": "https://ruzhansky.org",
          "affiliations": [
            {
              "name": "<sup>&#9833</sup>Analysis, Logic and Discrete Mathematics, Department of Mathematics, Ghent University",
              "url": ""
            }
          ]
        }
        ,
        
        {
          "author": "Haihui Wang<sup>&#9835</sup>",
          "authorURL": "https://math.buaa.edu.cn/szdw/axbck/yysxx/whh.htm",
          "affiliations": [
            {
              "name": "<sup>&#9835</sup>School of Mathematics, Beihang University",
              "url": ""
            }
          ]
        }
        ,
        
        {
          "author": "Xuechao Wang<sup>&#9833</sup>",
          "authorURL": "https://analysis-pde.org/graduate-students",
          "affiliations": [
            {
              "name": "",
              "url": ""
            }
          ]
        }
        ,
        
        {
          "author": "Michael Ruzhansky<sup>&#9833,&#9834</sup>",
          "authorURL": "https://ruzhansky.org",
          "affiliations": [
            {
              "name": "<sup>&#9834</sup>School of Mathematical Sciences, Queen Mary University of London",
              "url": ""
            }
          ]
        }
        
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Junqing </span>Huang</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">Home</a>
              </li>
              
              
              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">Publications</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">Projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/repositories/">Code/Software</a>
              </li>

              <!-- Blog -->
              <li class="nav-item ">
                <a class="nav-link" href="/blog/">Gallery</a>
              </li>


              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="post distill">

      <d-title>
        <div class="l-page">
          <h1>Semi-sparsity for Smoothing Filters</h1>
          
        </div>
      </d-title>
  
      <d-byline></d-byline> 
      
    

      <d-article>
        <!--<d-contents>
            <nav class="l-text figcaption">
            <h3>Contents</h3>
              <div><a href="#abstract">Abstract</a></div>
              <div><a href="#introduction">Introduction</a></div>
              <div><a href="#footnotes">Footnotes</a></div>
              <div><a href="#code-blocks">Code Blocks</a></div>
              <div><a href="#layouts">Layouts</a></div>
              <div><a href="#other-typography">Other Typography?</a></div>
              
            </nav>
        </d-contents>-->
        <div class="l-page">
          <h2 id="abstract">Abstract:</h2>

<p>We propose an interesting semi-sparsity smoothing algorithm based on a novel sparsity-inducing optimization framework. This method is derived from the multiple observations, that is, semi-sparsity prior knowledge is more universally applicable, especially in areas where sparsity is not fully admitted, such as polynomial-smoothing surfaces. We illustrate that this semi-sparsity can be identified into a generalized $L_0$-norm  minimization in higher-order gradient domains, thereby giving rise to a new “feature-aware” filtering method with a powerful simultaneous-fitting ability in both sparse features (singularities and sharpening edges) and non-sparse regions (polynomial-smoothing surfaces). Notice that a direct solver is always unavailable due to the non-convexity and combinatorial nature of $L_0$-norm minimization. Instead, we solve the model based on an efficient half-quadratic splitting minimization with fast Fourier transforms (FFTs) for acceleration. We finally demonstrate its versatility and many benefits to a series of signal/image processing and computer vision applications.</p>

<hr>
<h2 id="introduction">Introduction</h2>

<p>Filtering techniques, especially the feature-preserving algorithms, have been used as basic tools in signal/image processing fields. This favor is largely due to the fact that a variety of natural signals and visual clues (surfaces, depth, color, and lighting, etc.) tend to spatially have piece-wise constant or smoothing property, between which a minority of corner points and edges — known as sparse singularities or features formed by discontinuous boundaries convey an important proportion of useful information. On the basis of this prior knowledge, many filtering methods are promoted to have “feature-preserving” properties to preserve the sparse features while decoupling the local details or unexpected noise. The prevailing use of “feature-preserving” filtering methods is also found in many applications, including image denoise<d-cite key="donoho1995noising, perona1990scale"></d-cite>, tone mapping, and high dynamic range (HDR) image compression<d-cite key="farbman2008edge, he2012guided, tomasi1998bilateral"></d-cite>, details enhancement<d-cite key="farbman2008edge, he2012guided, paris2011local, xu2011image"></d-cite>, stylization<d-cite key="winnemoller2012xdog, lu2012combining"></d-cite>, and so on.</p>

<p>In the paper, we propose a semi-sparse minimization scheme for a type of smoothing filters. This new model is motivated by the sparsity-inducing priors used in recent cutting-edge filtering methods<d-cite key="ono2017l, xu2011image, ye2013sparse"></d-cite>. It turns out that sparsity priors could help to pursue piece-wise constant filtering results and they are particularly suitable for preserving the sparse features (singularities and edges) existing in signals/images. Nevertheless, it worthy notice that sparsity priors may fail in the regions coexisting sparse features and polynomial smoothing surfaces (See Fig. 1). This failure, as interpreted hereafter, is largely due to the fact that sparse priors may be no longer fully admitted in the polynomial-smoothing surfaces, thereby leading to strong stair-case artifacts when imposing sparse regularization in these regions. In contrast, we illustrate that semi-sparsity priors enjoy more favorable properties in simultaneously fitting both sharpening singularities and polynomial-smoothing surfaces. This major difference leads to a new smoothing behavior that helps to alleviate the drawbacks of many existing filtering methods. We will interpret the semi-sparsity model and show the universal applicability of semi-sparsity prior knowledge for natural images.</p>

<h2 id="observations">Observations:</h2>

<p>The \(L_0\) norm counts the number of its non-zero entries, which directly measures the degree of sparsity of the vector. As a metric, it has been proved to be capable of capturing the singularities and discontinues of signals. In signal and image processing, a corresponding \(L_0\) regularization is always a favorable and powerful mathematical tool to formulate the sparsity-induced priors. It has been used in a huge amount of existing works, including sparse signal/image recovering<d-cite key="donoho2003optimally, elad2010sparse"></d-cite> sparse representation and compressed sensing<d-cite key="donoho2006compressed"></d-cite> and so on.</p>

<div class="row mt-3">
    <div class="row justify-content-center">
        <div class="col-sm-8 mt-3 mt-md-0">
            <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/smooth_1d-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/smooth_1d-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/smooth_1d-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/smooth_1d.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

        </div>
    </div>
</div>
<div class="caption">
    Figure 1. An example of 1D signal smoothing. This signal is composed of the spikes (singularities), sharp edges, and slope line (or, polynomial surface). It is clear that $L_0$ gradient minimization<d-cite key="xu2011image"></d-cite>preserves spikes and sharp edges successfully but produces stair-case artifacts within the slope region (\textcolor{blue}{blue line}). In contrast, our model attains much better fitting (filtering) results in polynomial surfaces with comparable results in spikes and sharp edges (<font color="green"> red line </font>).
</div>

<p>As interpreted in Fig. 1, the non-zero elements of gradient \(\nabla u\) is not fully sparse but are densely distributed in some region. We say \(u\) is a so-called semi-sparse signal in gradient domains in this case. On the other hand, it is easy to verify that the second order gradient  \({\Delta u}\) is sparse. Without loss of generality, we define that \(u\) is a semi-sparse signal, if the higher-order gradients \({\nabla}^{n-1} u\)  and \({\nabla}^{n} u\) satisfy,</p>

\[\begin{equation}\label{eq:4}
	\begin{aligned}
		\begin{cases}
			&amp; {\left\Vert \nabla^{n} u\right\Vert}_0 &lt; M,\\
			&amp;{\left\Vert \nabla^{n-1} u\right\Vert}_0 &gt; N.
		\end{cases}
	\end{aligned}
\end{equation}\]

<p>where, \({\nabla}^{n}\) is a \(n\)-th (partial) differential operator, and \(M, N\) are some appropriate natural number with \({M\ll N}\). The idea of Eq. (4) is easy to understand, that is, the energy of \({\nabla}^{n} u\) is much smaller than that of  \({\nabla}^{n-1} u\). Intuitively, this happens if and only if the support\footnote{The support of vector \(u\) is its number non-zeros elements.} of \({\nabla}^{n} u\) is much less than that \({\nabla}^{n-1} u\); in other words, \({\nabla}^{n} u\) is much more sparse that \({\nabla}^{n-1} u\). Taking a piece-wise polynomial function with \(n\) degree into account, it is clear that the \(n\)-th order gradient \({\nabla}^{n} u\) is sparse, but that is not the case for \(k\)-th \((k&lt;n)\) order gradient \({\nabla}^{k} u\). This observation thus motivates us to extend Eq. (3) into higher-order gradient domains to regularize the semi-sparse signals with singularities and polynomial surfaces. In practice, the choice of \(n\) is usually determined by the property of signals.</p>

<h2 id="verification">Verification:</h2>

<p>We verify the semi-sparsity prior knowledge and show its universal applicability in natural images. For the sake of this purpose, we use Kodak image dataset<d-cite key="kodak"></d-cite> for interpretation and show the normalized distributions of higher-order gradients \({\nabla}^{n} u\) in Fig. 2.  Clearly, the distributions reveal heavy tails in the log-scale domain, which is consistent with the conclusions in many sparsity-induced models. Moreover, it is clear that more and more values of high-order gradients approach to  \(0\), as the order \(n\) increases. It means that the sparsity is enhanced when the order \(n\) goes higher. On the other hand, the gap of sparsity between the \(1^{st}\) and \(2^{nd}\) gradients is much bigger than that between the \(2^{nd}\) and \(3^{rd}\) gradient. This trend also holds in the higher-order cases and implicit that the sparsity tends to be bounded when increases the order \(n\). This trend also implies that the areas belonging to polynomial surfaces of degree \(n&gt; 2\) are relatively small and can be ignored in natural images.</p>

<div class="row mt-3">
    <div class="row justify-content-center">
        <div class="col-sm-8 mt-3 mt-md-0">
            <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/gradient_distribution-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/gradient_distribution-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/gradient_distribution-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/gradient_distribution.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

        </div>
    </div>
</div>
<div class="caption">
    Figure 2. The statistic distributions of the higher-order ($n=1-5$) gradients learned from the Kodak dataset<d-cite key="kodak"></d-cite>.
</div>

<p>The above claims intuitively motivate us to chose \(n=2\) as the highest order in most of our subsequent experiments. This choice has extra two-fold benefits: (1) \(n=2\) is the simplest semi-sparsity case, and (2) the computational cost of the proposed model is also moderate when \(n\) is small.</p>

<hr>

<h2 id="semi-sparsity-smoothing-model">Semi-sparsity Smoothing Model</h2>

<p>On the basis of Eq. \ref{eq:4} and verification of natural images, it is naturally to pose a semi-sparse minimization scheme for smoothing filters with the following generalized form,</p>

\[\begin{equation}

\begin{aligned}
\mathop{\min}_{u} {\left\Vert {u}-{Af}\right\Vert}_2^2+\alpha \sum_{k=1}^{n-1}  {\left\Vert {\nabla}^{k}u-{\nabla}^k (Af) \right\Vert}_2^p+\lambda{\left\Vert {\nabla}^{n} u \right\Vert}_0
\end{aligned}
\label{eq:5}
\end{equation}\]

<p>where $\alpha$ and \(\lambda\) are weights for balance. The first term in Eq. \ref{eq:5} is data fidelity with \(A\) adapted from Eq. (1). The second term measures the similarity of \(k\)-th (\(k&lt;n\)) higher-order gradients. The last term indicates that the highest-order gradient \({ {\nabla}^{n} u}\) should be fully sparse under the semi-sparsity assumptions.</p>

<p>In practice, the choice of \(n\) is determined by the property of signals. For natural images, the observations motivate us to choose \(n=2\) as the highest order for regularization. We chose \(p=2\) for most filtering cases in view of the non-sparsity property of \({\nabla}^{k}u\) and low computational cost\footnote{It is possible to choose \(p\) for other choices, \(p=1\), for example, while the numerical solution may be computationally expensive.}. As a result, we have the reduced semi-sparsity model with the form,</p>

\[\begin{equation}

\begin{aligned}
\mathop{\min}_{u} {\left\Vert {u}-{f}\right\Vert }_2^2+\alpha  {\left\Vert {\nabla}u-{\nabla}f\right\Vert }_2^2+\lambda{\left\Vert \Delta u \right\Vert}_0
\end{aligned}
\label{eq:6}
\end{equation}\]

<p>Here, we follow the property of global filters, letting \(K\) be Kronecker kernel for simplification. This choice is based on two-fold benefits: (1) \(n=2\) is the simplest case of our semi-sparsity model, and (2) a small \(n\) is enough for a wide range of practical tasks with moderate computational cost.</p>

<p>Mathematically, Eq. \ref{eq:5} (or, \ref{eq:6}) can be viewed as a general extension of the sparsity-induced \(L_0\)-norm gradient regularization<d-cite key="xu2011image"></d-cite> in the higher-order gradient cases. Despite the minor variants to \(L_0\)-norm gradient methods<d-cite key="xu2011image, ono2017l"></d-cite>, it has startling different properties compared with many existing filtering methods. On the one hand, it has been shown in many existing filtering methods such as bilateral filter<d-cite key="tomasi1998bilateral"></d-cite>, guided filter<d-cite key="he2012guided"></d-cite>, and TV-based filter<d-cite key="rudin1992nonlinear"></d-cite>that it is possible to guarantee high-quality smoothing results in the polynomial-smoothing areas, but it may inevitably lead to over-smoothing effects around the sharpening edges. On the other hand,  sparsity-induced models<d-cite key="nguyen2015fast, ono2017l, xu2011image"></d-cite> faithfully preserve the sharpening edges without over-smoothing results, but they may produce stair-case artifacts within the polynomial smoothing surfaces.</p>

<p>In a nutshell, it is difficult for both types of traditional filtering methods to simultaneously fit a signal coexisting the polynomial-smoothing surfaces and sparse singularities features (spikes and edges), since they may either produce over-smoothing results in singularities or introduce stair-case artifacts in the polynomial smoothing surfaces. In contrast, our semi-sparsity minimization model, as demonstrated in the following experimental parts, avoids the dilemma and it is possible to retain comparable edge-preserving properties in strong edges and spikes and more appropriate results in the polynomial-smoothing surfaces, giving arise to a so-called simultaneous-fitting ability in both spikes and polynomial-smoothing regions. This property provides a new paradigm to deal with both cases in high-level fidelity, which contributes its benefits and advantages to many traditional methods.</p>

<h2 id="half-quadratic-solver">Half-quadratic Solver</h2>

<p>Despite the simple form of Eq. \ref{eq:5} (or \ref{eq:6}),  a direct solution is not always available due to the non-convexity and combination property of \(L_0\)-norm. In the literature, such a minimization problem is solved by greedy algorithms<d-cite key="tropp2004greed"></d-cite> to iteratively select the sub-optimal solutions, or reduced with appropriate relaxations<d-cite key="chen2001atomic, wang2008new"></d-cite>. Recently, different efficient algorithms such as half-quadratic (HQ) splitting<d-cite key="allain2006global, wang2008new"></d-cite>, iterative hard-thresholding (IHT)<d-cite key="blumensath2009iterative, sun2017convergence"></d-cite>, and alternating direction method of multipliers (ADMM)<d-cite key="boyd2011distributed, ono2017l"></d-cite> have been proven to be suitable for \(L_0\)-norm regularization.</p>

<p>We employ the HQ splitting technique for the semi-sparsity minimization since it is easy to implement and has almost the least computational complexity for large-scale problems. 
The main idea of the HQ splitting algorithm is to introduce an auxiliary variable to split the original problem into sub-problems that can be solved easily and efficiently. For completeness, we briefly introduce the half-quadratic (HQ) splitting technique with a general \(L_0\)-norm regularized form,</p>

\[\begin{equation}
\begin{aligned}
\mathop{\min}_{u} \mathcal{F}(u) + \lambda {\left\Vert Hu \right\Vert }_0
\end{aligned}
\label{eq:7}
\end{equation}\]

<p>where \(\mathcal{F}\) is a proper convex function, \(H\) is a (differential) operator and the \(L_0\)-norm regularized term is a non-convex, non-smoothing but a certain separable function.</p>

<p>By introducing an auxiliary variable \(w\), it is possible to rewrite the above minimization problem Eq. \ref{eq:7} as,</p>

\[\begin{equation}
\begin{aligned}
\mathop{\min}_{u} \mathcal{F}(u) + \lambda {c(w)}  + \beta {\left\Vert  Hu - w \right\Vert }_2^2
\end{aligned}
\label{eq:8}
\end{equation}\]

<p>where \(c(w) = {\left\Vert w \right\Vert}_0\) and \({\left\Vert  Hu - w \right\Vert }_2^2\) is introduced to measure the similarity of \(w\) and \(Hu\). The solution of Eq. \ref{eq:8} globally converges to that of Eq. \ref{eq:7} when the parameter \(\beta \to \infty\).</p>

<p>Clearly, the proposed semi-sparsity model is a special case of Eq. \ref{eq:7}, where \(\mathcal{F}(u) = {\left\Vert {u}-{f}\right\Vert }_2^2+\alpha {\left\Vert {\nabla}(u-f) \right\Vert }_2^2\) and \(H\) is the Laplace operator \({\nabla}\). The optimal solution is then attainable by iteratively solving the following two sub-problems.</p>

<h3>Sub-problem 1:</h3>
<p>By fixing the variable \(w\), the objective function of Eq. \ref{eq:6} reduces to a quadratic function with respect to \(u\), giving an equivalent minimization problem,</p>

\[\begin{equation}

\begin{aligned}
\mathop{\min}_{u} {\left\Vert {u}-{f}\right\Vert }_2^2+\alpha {\left\Vert {\nabla}u -{\nabla} f \right\Vert }_2^2 +\beta{\left\Vert \Delta u -w \right\Vert }_2^2.
\end{aligned}
\label{eq:9}
\end{equation}\]

<p>Clearly, Eq. \ref{eq:9} has a closed-form solution due to the quadratic form w.r.t. \(u\). Let \(\boldsymbol{D}\) and \(\boldsymbol{L}\) be discrete gradient operator and Laplace operator in matrix-form, the optimal solution \(u\) is then given by the following linear system:</p>

\[\begin{equation}

\begin{aligned}
(\boldsymbol{I} + \alpha \boldsymbol{D}^T \boldsymbol{D} + \beta  \boldsymbol{L}^T \boldsymbol{L}) u =  	(\boldsymbol{I} + \alpha \boldsymbol{D}^T \boldsymbol{D}) f + \beta  \boldsymbol{L}^T w,
\end{aligned}
\label{eq:10}
\end{equation}\]

<p>where \(\boldsymbol{I}\) is identity matrix. Since the left-hand side of Eq. \ref{eq:10} is symmetric and semi-positive, many solvers such as Gauss-Seidel and preconditioned conjugate gradients (PCG) methods<d-cite key="saad2003iterative"></d-cite> are applicable for an efficient solution. It is also possible to use fast Fourier transforms (FFTs) for acceleration, which can significantly reduce the computational cost, in particular for a large-scale problem such as millions of variables in the context of image processing.</p>

<h3>Sub-problem 2:</h3>
<p>By analogy, \(w\) is solved with a fixed \(u\) and the first two terms in Eq. \ref{eq:6} are constant with respect to \(w\), thus it is equivalent to solving the following problem,</p>

\[\begin{equation}
\begin{aligned}
\mathop{\min}_{w} {\beta} {\left\Vert \Delta u -w \right\Vert }_2^2 + {\lambda}{\left\Vert w \right\Vert}_0
\end{aligned}
\label{eq:11}
\end{equation}\]

<p>where \(c(w)\) counts the number of non-zero elements in \(w\). As demonstrated in many existing methods<d-cite key="blumensath2009iterative, wang2008new, xu2011image"></d-cite>, Eq. \ref{eq:11} is separable and can be reduced to  one-dimensional minimization problem — that is, each variable \(w_i\) is estimated individually, giving by the formula,</p>

\[\begin{equation}
\begin{aligned}
{w_i} =
\begin{cases}
0, &amp;\quad {\left\Vert \Delta u_i \right\Vert }_2^2&lt;\frac{\lambda}{\beta},\\
\Delta u_i, &amp;\quad {\left\Vert \Delta u_i \right\Vert }_2^2 \geq \frac{\lambda}{\beta}.
\end{cases}
\end{aligned}
\label{eq:12}
\end{equation}\]

<p>It is also known that Eq. \ref{eq:12} is a hard-threshold operator and can be solved efficiently. The HQ splitting algorithm solves two sub-problems iteratively, providing an iterative scheme for the semi-sparsity minimization. Notice that both sub-problems have closed-form solutions in low computational complexity, which makes the \(L_0\)-norm regularized problem empirically solvable even for a large-scale of variables. The numerical results will demonstrate the effect and efficiency of the HQ splitting scheme.</p>

<p>The above HQ splitting scheme gives rise to an iterative hard-thresholding algorithm, the convergence of which has been extensively analyzed under convex objective function assumptions<d-cite key="allain2006global, wang2008new"></d-cite>. It has shown in <d-cite key="xu2011image"></d-cite> that such a scheme can be directly extended to non-convex \(L_0\) gradient regularization for high-quality results. In <d-cite key="blumensath2009iterative"></d-cite>, a similar iterative hard-threshold algorithm is proposed for compressed sensing, where the convergence is built under the restricted isometric property (RIP) and it is also not applicable to our case. It turns out recently that such an iterative thresholding algorithm can be extended to more general non-convex and non-smooth cases, for example, our semi-sparsity minimization, under the Kurdyka–Lojasiewicz property<d-cite key="attouch2013convergence"></d-cite>. The concreted discussion is out of the scope here and the interested reader is referred to the literature<d-cite key="attouch2013convergence, sun2017convergence, zeng2016sparse"></d-cite> for more details.</p>

<h2 id="experimental-results">Experimental Results</h2>

<p>In this section, we show the simultaneous-fitting property of the semi-sparse minimization of Eq. \ref{eq:6} and its advantages in producing the “edge-preserving” smoothing results. We emphasize the  “edge-preserving” property as it is vital for filtering tools to remove the small-scale details but preserve the sharpening variations. The proposed approach is compared with a variety of edge-aware filtering methods, including bilateral filter (BF)<d-cite key="tomasi1998bilateral"></d-cite>, total variation (TV)<d-cite key="rudin1992nonlinear"></d-cite>, \(L_1\)-TV<d-cite key="aujol2006structure"></d-cite>, guided filter (GF)<d-cite key="he2012guided"></d-cite>, BM3D denoising<d-cite key="dabov2007image"></d-cite>, weighted least square (WLS) filter<d-cite key="farbman2008edge"></d-cite>, \(L_0\) gradient minimization <d-cite key="xu2011image"></d-cite>, relative total variation (RTV)<d-cite key="xu2012structure"></d-cite>, total generalization variation (TGV) method<d-cite key="knoll2011second"></d-cite>, and so on. The experimental results are verified on both synthetic and natural images. For the fairness of comparison, the parameters in each filtering algorithm are either configured with a greedy search strategy to give visual-friendly results or fine-tuned to reach a similar level of smoothness, qualified by the mean absolute average (MAE) or peak-signal-noise-ratio (PSNR) metrics.</p>

<h3>Smoothing Filters:</h3>
<p>We first simulate a \(1\)-D noisy signal and show the performance for persevering step-wise edges and polynomial smoothing region. As shown in Fig. (1), the cutting-edge \(L_0\) gradient minimization<d-cite key="xu2011image"></d-cite> attains high-quality results in both spikes and step-wise edges, but produces strong stair-case results in polynomial-smoothing regions. As aforementioned, the failure is largely caused by the invalidation of the sparse gradient regularization in the corresponding regions. In contrast, our semi-sparse model gives more accurate fitting results in the slope region with comparable performance in both singularities and sharpening edges.</p>

<div class="row">
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_3a-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_3a-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_3a-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_3a.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">Input</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_3g-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_3g-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_3g-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_3g.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">BM3D</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_3i-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_3i-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_3i-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_3i.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">RTV</figcaption>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_3b-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_3b-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_3b-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_3b.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">BF</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_3h-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_3h-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_3h-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_3h.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">WLS</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_3j-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_3j-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_3j-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_3j.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">TGV</figcaption>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_3c-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_3c-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_3c-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_3c.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">GF</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_3e-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_3e-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_3e-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_3e.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">$L_1$-norm</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_3k-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_3k-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_3k-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_3k.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">Ours</figcaption>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_3d-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_3d-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_3d-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_3d.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">TV</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_3f-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_3f-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_3f-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_3f.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">$L_0$-norm</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_3l-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_3l-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_3l-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_3l.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">GT</figcaption>

</figure>

    </div>
  </div>

<div class="caption">
    Figure 3. An visual comparison of filtering methods over polynomial-smoothing surfaces. (a) Input, (b) BF ($w = 25$, $\delta =[8, 0.25]$), (c) GF($w=25$, $\epsilon =0.01^2$),  (d) TV ($\lambda = 0.3$), (e)$L_1$-TV, (f) $L_0$ smoothing ($\lambda = 0.01, \kappa =1.05$), (g) BM3D, (h) WLS ($\alpha = 0.5$, $\lambda = 1.2$),  (i) RTV ($\lambda = 0.05$, $\sigma = 2.0$), (j) TGV ($\lambda = 0.008$, $\alpha_0=0.05$, $\alpha_1 = 0.0025$),  (k) Ours ($\alpha = 0.01$, $\lambda =0.02$), (l) Ground truth. PSNR: (a)-(k): 27.31, 39.10, 38.40, 39.72, 41.25, 40.50, 41.10, 41.49, 41.63, 42.52, 46.64. We compute PSNR by cropping out 12 boundary pixels for fairness comparison.
</div>

<p>To further demonstrate the virtues of our semi-sparse smoothing filter, we compare the results of a synthesized color image that is composed of a piece of polynomial smoothing surface ({\color{green} green region}) and step-wise edges formed by different constant regions.  As shown in Fig. (3),  our method attains similar performance as that in the 1D case. Among them, TV method<d-cite key="rudin1992nonlinear"></d-cite> gives a high-quality fitting result within the interval of slope line, but produces over-smoothing results around the sharpening edge; \(L_0\) minimization<d-cite key="xu2011image"></d-cite> preserves the edges but leads to strong stair-case artifacts in the green region and (WLS) filter<d-cite key="farbman2008edge"></d-cite> also gives a high-quality result, yet, with slight deviations in green region. The second-order TGV method<d-cite key="knoll2011second"></d-cite> significantly reduces the stair-case artifacts in the slant surface and also reveals high performance in sharpening edges, while our semi-sparsity exhibits a similar visual result and outperforms around 4 dB improvement under the PSNR metric. Other methods, to some extent, either blur the strong edges or produce piece-wise constant results in the green region.</p>

<div class="row">
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_4a-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_4a-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_4a-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_4a.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">Input</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_4f-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_4f-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_4f-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_4f.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">WLS</figcaption>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_4b-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_4b-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_4b-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_4b.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">BF</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_4g-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_4g-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_4g-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_4g.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">BM3D</figcaption>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_4c-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_4c-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_4c-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_4c.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">GF</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_4h-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_4h-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_4h-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_4h.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">RTV</figcaption>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_4d-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_4d-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_4d-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_4d.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">TV</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_4i-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_4i-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_4i-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_4i.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">TGV</figcaption>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_4e-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_4e-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_4e-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_4e.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">L0</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_4j-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_4j-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_4j-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_4j.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">Ours</figcaption>

</figure>

    </div>
  </div>

<div class="caption">
    Figure 4. Visual comparison of smoothing results on a face image.  (a) Input, (b) BF ($w = 25$, $\delta =[8, 0.25]$), (c) GF ($w=25$, $\epsilon =0.01^2$),  (d) TV ($\lambda = 0.2$),  (e) $L_0$ smoothing ($\lambda = 0.01$, $\kappa =1.2$), (f) WLS ($\alpha = 0.5$, $\lambda = 1.2$),  (g) BM3D ($\delta=30$),  (h) RTV ($\lambda = 0.02$, $\sigma = 2.0$), (i) TGV ($\lambda = 0.01$, $\alpha_0=0.002$, $\alpha_1 = 0.002$),  (j) Ours ($\alpha = 0.1$, $\lambda =0.02$). As suggested, the filters are processed in logarithmic intensity for better visual results. MAE: (b)-(j): 0.0115, 0.0117, 0.0118, 0.0116,  0.0117, 0.0119, 0.0117, 0.0116, 0.0117.
</div>

<p>In Fig. (4), we also show the results on natural images. Specifically, we apply the filtering methods on a face image consisting of multiple polynomial surfaces (face) and strong edges (face contour and hair). In this situation, it is usually difficult to produce a visual-pleasant result. The dilemma mainly underpins the fact that both freckles and hair reveal high-frequency characteristics, while the preferred result may require to preserve the details in hair regions but to remove freckles in smoothing face regions. As shown in Fig. (4), most existing “edge-aware” filtering methods reveal limited performance in keep the smoothing balance between the high-frequency hairs and smoothing face regions. For example, bilateral filter (BF)<d-cite key="tomasi1998bilateral"></d-cite> and guided filter (GF)<d-cite key="he2012guided"></d-cite> produce acceptable smoothing results in face regions, while they also blur the hair details slightly. BM3D method<d-cite key="dabov2007image"></d-cite> is originally proposed for image denoising and usually reveals high performance for noisy-free results, while it has limited improvement in such cases because of the complexity and diversity of potential details to be filtered out. Notice also that \(L_0\) minimization<d-cite key="xu2011image"></d-cite> produces stripe-like results in face regions. In contrast, our semi-sparsity method removes the details in face regions but also retains high-quality edges in the hair region, giving rise to a more promising  results.</p>

<div class="row">
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_5a-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_5a-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_5a-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_5a.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">Input</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_5a-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_5a-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_5a-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_5a.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">Close-ups</figcaption>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_5b-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_5b-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_5b-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_5b.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">$\alpha = 10, \lambda =0.002$</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_5b-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_5b-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_5b-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_5b.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">$\alpha = 0.1, \lambda =0.002$</figcaption>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_5c-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_5c-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_5c-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_5c.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">$\alpha = 10, \lambda =0.01$</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_5c-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_5c-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_5c-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_5c.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">$\alpha = 0.1, \lambda =0.01$</figcaption>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_5d-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_5d-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_5d-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_5d.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">$\alpha = 10, \lambda =0.1$</figcaption>

</figure>

        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_5d-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_5d-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_5d-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_5d.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">$\alpha = 0.1, \lambda =0.1$</figcaption>

</figure>

    </div>
  </div>

<div class="caption">
    Figure 5. Our semi-sparsity smoothing results of an 2D image with varying parameters $\alpha$ and $\beta$. Note that the filtering algorithm is processed in the logarithmic intensity for better visual effects.
</div>

<p>For complementary, we briefly explain the roles of \({\alpha, \beta}\) in controlling the smoothness of the semi-sparse minimization model.  A visual comparison with varying parameters $\alpha$ and $\beta$ is presented in Fig. (5). In each row, $\alpha$ is fixed and \(\lambda\) is gradually increased to give more smoothing results; while, in each column, \(\lambda\) is fixed and $\alpha$ is increased to remove more strong local details. As we can see, \(\lambda\) plays a crucial role in controlling the smoothness of results and a larger \(\lambda\) penalizes to remove more local details and lead to more smoothing results. Over-weighting the second-order term will penalize smoothing regions as well as fine features and therefore over-smooth the details. A similar trend is observed for $\alpha$ but with a decreasing value and the results are not so sensitive to the varying of $\alpha$.  Notice that $\alpha$ is reduced by \(\kappa\) time in each iteration, because the penalty for the first-order gradient in Eq. \ref{eq:5} and \ref{eq:6} play a similar role as the data-fidelity term, thus it has a relatively small impact on the global smoothing results but mainly adjusts the local details.</p>

<h3>Higher-order Regularization:</h3>

<p>The choice of order \(n\) in Eq. \ref{eq:5} for sparse regularization is generally determined by the property of signals. For natural images, we interpret that \(n=2\) is usually enough to give favorable results in most cases, although further improvements can be attained with the regularization over higher-order gradient domains. As shown in Fig. (6), we illustrate this observation by comparing the smoothing results in which the sparsity constraints are imposed from the \(1^{st}\) to \(3^{rd}\) orders regularizations. As shown in \(L_0\)-gradient regularization<d-cite key="xu2011image"></d-cite>, the \(1^{st}\) order case may introduce strong staircase effects in the flower region and background. Under a similar level of smoothness, the proposed method alleviates the staircase artifacts, and no obvious difference appears except in some tiny regions for the \(2^{nd}\) and \(3^{rd}\) cases. This result, to some extent, provides validation of the conclusion that the regions having the degree (\(n \geq 3\)) polynomial surfaces in natural images occupy very tiny regions in natural images, which can be treated as spikes approximately.</p>

<div class="row">
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_6a-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_6a-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_6a-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_6a.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">Input</figcaption>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_6b-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_6b-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_6b-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_6b.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">GF</figcaption>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_6c-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_6c-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_6c-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_6c.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">WLS</figcaption>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_6d-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_6d-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_6d-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_6d.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">BM3D</figcaption>

</figure>

    </div>
  </div>

<div class="caption">
    Figure 6. Comparison of the smoothing results on a natural image with the sparse regularization from the $1^{st}$-order to $3^{rd}$-order gradient domains, respectively. PSNR: (b)-(d): 33.54, 33.96, 33.16 (Zoom in for better view).
</div>

<p>This result can be also explained from the higher-order gradient distributions of natural images in Fig. 2, where the sparseness of the higher-order gradient signal is gradually enhanced when the order \(n\) increases. Moreover, there exists a bound of the spareness when the order \(n\) keeps increasing, as the distributions tend to be more and more similar. On the other hand, it is also clear that the gap of sparseness of the \(1^{st}\) and \(2^{nd}\) order gradients is much bigger than that of the \(2^{nd}\) and \(3^{rd}\) order gradients. A similar trend is also observed in the higher-order cases. Accordingly, we claim that the polynomial-smoothing surfaces with degree (\(n \geq 3\)) do not frequently occur in natural images, the area of which is relatively smaller than that of the \(n=2\) case. Therefore, it is usually enough to impose sparse regularization on second-order gradients for natural images. Another consideration of choosing the \(2^{nd}\) order gradient for regularization is to reduce the computation cost in many practical applications.</p>

<h2 id="applications">Applications</h2>

<p>Similar to many existing filtering methods, it is possible to use our semi-sparsity model in various signal processing fields. We describe several representative ones involving 2D images, including image detail manipulation, high dynamic range (HDR) image compression, image stylization and abstraction.</p>

<h3>Details Manipulation:</h3>

<p>In many imaging systems, the captured images may suffer from degradation in details for the inappropriate focus or parameter-settings in image tone mapping, denoising, and so on. In these situations, “edge-aware” filtering methods can be used to help recover or exaggerate the degraded details. In general, it is popular to use the smoothing filters to decompose an image into two components: a piece-wise smoothing base layer and a detail layer; then either of them can be remapped and combined for reconstructing better visual results. We compare the results with the cutting-edge methods<d-cite key="farbman2008edge, tomasi1998bilateral, he2012guided, knoll2011second,  xu2011image"></d-cite>. For fairness, all filtering methods produce a similar level of smoothing results. The detail layer is then obtained by subtracting the smoothing base-layer from the original image. The enhanced image is reconstructed by combing the re-scaled (\(\times 3.5\)) detail layer with the base-layer. As we can see in Fig. 7, the guided filter<d-cite key="he2012guided"></d-cite>, WLS filter<d-cite key="farbman2008edge"></d-cite>, BM3D denoising<d-cite key="dabov2007image"></d-cite> and total generalization variation (TGV)<d-cite key="knoll2011second"></d-cite> methods may cause halo artifacts around strong structures; while \(L_0\) smoothing<d-cite key="xu2011image"></d-cite> helps to reduce the halos but leads to crash boundaries due to the inappropriate stair-case filtering results in the polynomial-smoothing regions. In contrast, our semi-sparsity model receives the best result with rich local details but tiny halo artifacts.</p>

<p>fig5_</p>

<p>A multi-scale strategy is also introduced for detail enhancement.  As suggested in WLS filter<d-cite key="farbman2008edge"></d-cite>,  the multiple base layers are generated under different smoothing levels, and the detail layers are then obtained by subtracting one from the former smoothing result. As shown in Fig. (8), the small, median and coarse levels are applied for producing smoothing base layers and the final merged result.</p>

<div class="row">
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_8_orig-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_8_orig-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_8_orig-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_8_orig.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_8_fine-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_8_fine-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_8_fine-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_8_fine.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_8_medium-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_8_medium-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_8_medium-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_8_medium.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_8_coarse-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_8_coarse-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_8_coarse-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_8_coarse.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_8_combine-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_8_combine-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_8_combine-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_8_combine.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
  </div>

<div class="caption">
    Figure 8. Multi-scale details manipulation. Three scales: (b) small ($\alpha = 0.01, \lambda =0.001$) and (c) median ($\alpha = 0.1$, $\lambda =0.005$), (d) coarse ($\alpha = 1.0, \lambda =0.02$), and (e) is obtained by scaling ($\times 2$) detail-layers.
</div>

<h3>HDR Image Compression:</h3>

<p>This technique arises from the visual-friendly display of high-quality HDR images. It is similar to image details manipulation and an HDR image is usually assumed to be decomposed into a base layer and a detail layer. The base layer is piece-wise smoothing with high dynamic range contrast, which needs to be compressed for display or visual purposes. The compressed smoothing output is then re-combined with the detail layer to reconstruct a new image. The challenge here is to decouple the base layer and maintain reasonable image contrast during dynamic range compression while keeping a balance of the smoothness between the piece-wise areas and sharp discontinuities to avoid halos around strong edges and over-enhancement of spatial local details.</p>

<p>As shown in Fig. (9), bilateral filter<d-cite key="durand2002fast"></d-cite> produces an LDR image with the fine-balance global illumination but the details in local, which is partially recovered by the gradient domain (GD) compression<d-cite key="fattal2002gradient"></d-cite> and WLS filter<d-cite key="farbman2008edge"></d-cite> but they still have limitations in bringing out local tiny details; while \(L0\) smoothing<d-cite key="xu2011image"></d-cite> tends to produce exaggerated local details, which is mainly caused by the stair-case fitting results in polynomial smoothing surfaces. In contrast, our semi-sparse filtering method provides a result with appropriate contrast in local and fine-balanced global image illumination.  A similar result is also found in Fig. (10), where we only replace the filter method and the color and saturation share the same configuration as in paper<d-cite key="farbman2008edge"></d-cite> for a fair comparison. Visually, the WLS filter<d-cite key="farbman2008edge"></d-cite>, guided filter<d-cite key="he2012guided"></d-cite>, and total generalization variation (TGV) are possible to produce high-quality LDR results, but they may have limitations in compressing the dynamic range around strong edges; while our method receives a comparable result as the well-known gradient domain<d-cite key="fattal2002gradient"></d-cite> method.  Notice that L0 smoothing<d-cite key="xu2011image"></d-cite> method may also lead to artifacts due to the inappropriate smoothing results in the polynomial-smoothing surfaces.</p>

<div class="row">
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_9a-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_9a-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_9a-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_9a.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_9b-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_9b-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_9b-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_9b.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_9c-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_9c-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_9c-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_9c.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_9d-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_9d-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_9d-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_9d.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_9e-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_9e-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_9e-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_9e.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
</div>

<div class="caption">
    Figure 9. HDR image compression. From left to right: (a) Bilateral filte (BF) (b) Gradient domain (GD) compression,  (c) WLS filter,  (d) $L_0$ smoothing and (e) Our result ($\alpha = 0.5, \lambda =0.01$). The results of (a)-(d) are adapted from the authors' projects. TMQI (Q): 0.8895, 0.9305, 0.8965, 0.9562.
</div>

<div class="row">
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_10a-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_10a-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_10a-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_10a.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_10b-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_10b-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_10b-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_10b.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_10c-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_10c-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_10c-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_10c.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_10d-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_10d-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_10d-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_10d.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_10e-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_10e-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_10e-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_10e.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
  </div>

<div class="caption">
    Figure 10. HDR image compression. (a) WLS filter ($\alpha= 1.2, \lambda=5.0$), (b) Guided filter ($r=15, \delta=[8, 2]$),  (c) L0 smoothing($\lambda = 0.5, \kappa = 1.2$),  (d) Total generalization variation (TGV) ($\lambda = 0.02, \alpha_0=0.1, \alpha_1 = 0.05$), and (e) Ours ($\alpha = 1.0, \lambda =0.4$). For fairness, all the filters produce a similar level smoothing results under the same color and saturation configurations.TMQI (Q): 0.9681 0.9624   0.9568 0.9679,  0.9712.
</div>

<p>To verify the performance of these existing smoothing filters for HDR image compression, we further take a quantitative evaluation based on the Anyhere dataset<d-cite key="greg2003high"></d-cite>. The dataset has 33 widely-used HDR images with different illumination distribution. In general, it is difficut for HDR compression tasks for an objective image quality assessment, because the corresponding ground-truth images are always not available. Recently, no-reference approaches based on statistical models have also shown promising success in predicting the quality of images. As suggested in <d-cite key="huang2021intrinsic"></d-cite>, we use Tone Mapped Image Quality Index (TMQI)<d-cite key="yeganeh2012objective"></d-cite>, Integrated Local Natural Image Quality Evaluator (IL-NIQE)<d-cite key="zhang2015feature"></d-cite> and Neural Image Assessment (NIMA)<d-cite key="talebi2018nima"></d-cite> for evaluation. The TMQI<d-cite key="yeganeh2012objective"></d-cite> index is a full-reference assessment method between HDR image and the output LDR image, in which Structural Fidelity (SF) and Statistical Naturalness (SN) are considered to provide an objective quality assessment. The SF index is based on the multi-scale structural similarity (SSIM) approach<d-cite key="wang2004image"></d-cite> to provide a perceptual predictor of structural fidelity. The SN index is based on a statistic method to takes the natural image statistics of brightness, contrast, visibility and details into account. IL-NIQE<d-cite key="zhang2015feature"></d-cite> and  NIMA<d-cite key="talebi2018nima"></d-cite> are two no-reference image assessments. The former is a learning method based on natural image statistics features derived from color, luminance, gradient and structure information; and the latter attempts to predict consistent aesthetic scores with human opinions using convolutional neural networks. The NIMA<d-cite key="talebi2018nima"></d-cite> method is trained on a large-scale natural image dataset for perceptually-aware no-reference quality assessment. For a fairness comparison, all the filters are configured to produce a similar level smoothing results under the same color and saturation as suggested in <d-cite key="farbman2008edge"></d-cite>. The statistical results are shown in \textbf{Table} \ref{tab:tab1}, where the best two results are highlighted with \textbf{bold} and \textbf{underline}, respectively.  The advantages of the proposed method are also verified with consistent visual-results in Fig. (9) and (10).</p>

<h3>Image Stylization and Abstraction:</h3>

<p>This interesting task aims to produce different stylized results or non-photorealistic rendering (NPR) of an image. In this case, the proposed semi-sparse filtering method is firstly applied for an image to remove the local textures and details; the main structure of the smoothed image is then, as interpreted in<d-cite key="winnemoller2012xdog"></d-cite>, extracted by using the Difference-of-Gaussian (DoG) operator; and the stylized result is finally attained by merging the filter result and main structures. Due to the simultaneously-smoothing property of the semi-sparse model, it avoids introducing extra edge lines in polynomial surfaces. Despite the isotropic property of the DoG operator, it is usually enough to produce visual-friendly results. As shown in<d-cite key="winnemoller2012xdog"></d-cite>, it is also possible to produce different artistic effects such as hatching, woodcut, watercolor, and so on. We show two simple examples: pen and color-pencil drawing effects in Fig. (11). One can also combine our semi-sparse smoothing filter model with more complex configurations as illustrated in<d-cite key="lu2012combining"></d-cite> to produce more reasonable and aesthetic stylized results.</p>

<div class="row justify-content-md-center"> 
  <div class="col col-lg-3">
      <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_11a-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_11a-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_11a-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_11a.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">Ward's</figcaption>

</figure>

  </div>
    <div class="col col-lg-3">
      <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_11b-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_11b-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_11b-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_11b.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">GD</figcaption>

</figure>

  </div>
    <div class="col col-lg-3">
      <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sp/Fig_11c-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sp/Fig_11c-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sp/Fig_11c-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/sp/Fig_11c.png" class="img-fluid" width="auto" height="auto" alt="zoom" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="subcaption">IIT+BF (Ours)</figcaption>

</figure>

  </div>
</div>
<div class="caption">
    Figure 11. Image stylization.  From left to right: (a) Input image, (b) Pen drawing, and (c) Color pencil effect.
</div>

<h2 id="conclusion">Conclusion</h2>

<p>This paper has described a simple semi-sparse minimization scheme for smoothing filters, which is formulated as a general extension of \(L_0\)-norm minimization in higher-order gradient domains. We demonstrate the virtue of the proposed method in preserving the singularities and fitting the polynomial-smoothing surfaces. We also show its benefits and advantages with a series of experimental results in both image processing and computer vision. One of the drawbacks is the high computational cost of solving the iterative minimization problem, which could be partially alleviated by resorting to more efficient solutions with a faster convergence rate. We leave the work for future studies.</p>


        </div>
          
        
      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>

      <d-bibliography src="/assets/bibliography/paper_reference.bib"></d-bibliography><div id="giscus_thread" style="max-width: 960px; margin: 0 auto;">
  <script>
    let giscusTheme = localStorage.getItem("theme");
    let giscusAttributes = {
        "src": "https://giscus.app/client.js",
        "data-repo": "Junqing-Huang/al-folio",
        "data-repo-id": "MDEwOlJlcG9zaXRvcnk2MDAyNDM2NQ==",
        "data-category": "Comments",
        "data-category-id": "DIC_kwDOA5PmLc4CTBt6",
        "data-mapping": "title",
        "data-strict": "1",
        "data-reactions-enabled": "1",
        "data-emit-metadata": "0",
        "data-input-position": "bottom",
        "data-theme": giscusTheme,
        "data-lang": "en",
        "crossorigin": "anonymous",
        "async": "",
    };


    let giscusScript = document.createElement("script");
    Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
    document.getElementById("giscus_thread").appendChild(giscusScript);
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a>
</noscript>
</div>
<!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2023 Junqing  Huang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>.

      </div>
    </footer>

      <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

      
      

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

    </div>
  
</body>
</html>
